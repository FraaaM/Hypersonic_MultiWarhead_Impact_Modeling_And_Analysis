import math
def calculate_penetration(L, d, rho_p, v0, rho_t, tau_0, c, alpha, k_pr, v_crit=2000, k = 1.0):
    """
    Функция для расчета параметров гиперзвукового удара цилиндрического снаряда.
    
    Параметры:
    - L: длина цилиндра (м)
    - d: диаметр цилиндра (м)
    - rho_p: плотность снаряда (кг/м³)
    - v0: начальная скорость (м/с)
    - rho_t: плотность мишени (кг/м³)
    - tau_0: прочность мишени, Па (типичное значение для прочных материалов)
    - c: скорость звука в мишени (м/с)
    - alpha: коэффициент потери массы (0 ≤ alpha < 1)
    - v_crit: критическая скорость (м/с), по умолчанию 2000 м/с
    - k_pr: коэффициент проницаемости материала 
    
    Возвращает словарь с вычисленными параметрами.
    """
    # Площадь поперечного сечения
    A0 = math.pi * (d/2)**2
    # Объем и масса снаряда
    V = A0 * L
    m = rho_p * V
    
    # Кинетическая энергия
    E = 0.5 * m * v0**2
    
    # Импульс
    I = m * v0

    tau_s = tau_0 + 0.5 * d * math.sqrt(rho_p * rho_t)          # Вычисляем эффективную прочность мишени(на глубине)
    d_crater_2 = (( (E / tau_s)**0.255 * (I / (rho_t * c))**0.078 + 1.20 * math.sqrt(rho_p / rho_t) * d ) * ((d / L)**(1/3)) )
    
    tau_s = tau_0 + 0.5 * L * math.sqrt(rho_p * rho_t)          # Вычисляем эффективную прочность мишени(на глубине)
    h_hydro_2 = (0.14 * (E / tau_s)**0.255 * (I / (rho_t * c))**0.078 + 0.60 * math.sqrt(rho_p / rho_t) * L ) *  ((L / (d))**(1/6))


    
    
    # Эффективная масса после потери
    m_eff = m * (1 - alpha)
    
    # Глубина проникновения (фаза твёрдого тела)
    h_solid =  ( (k_pr * ( (m_eff * v_crit) / ((d)**2))) ) 

    # Диаметр поражённой зоны
    r_solid = math.sqrt((A0 * (1 + v_crit / c)) / math.pi)
    
    # Общая глубина проникновения
    h_total = h_hydro_2 + h_solid
    
    return {
        'm': m,
        'E': E,
        'I': I,
        'h_hydro_2': h_hydro_2,
        'd_crater_2': d_crater_2,
        'h_solid': h_solid,
        'r_solid': r_solid,
        'h_total': h_total,
        'A0': A0
    }

# Входные данные из примера РАКЕТА САРМАТА
L = 0.5#0.28#1.5#0.58  # длина цилиндра (м)
d = 0.18#0.24#0.16#0.26 #0.27593   # Диаметр цилиндра (м)
rho_p = 8500    # плотность снаряда (кг/м³)
v0 = 7000       # начальная скорость (м/с)
rho_t = 2500    # плотность мишени (кг/м³)
tau_0 = 5e6   # статическая прочность (Па)
c = 4000        # скорость звука (м/с)
alpha = 0.40   # коэффициент потери массы, подобран для примера
g = 9.81        # ускорение свободного падения (м/с²), для вывода
k_pr = 0.0000007 #коэффициент проницаемости материала

# Вычисление параметров
results = calculate_penetration(L, d, rho_p, v0, rho_t, tau_0, c, alpha, k_pr)

# Вывод результатов
print(f"Длина тела L = {L} м, диаметр d = {d} м,\nПлотность тела ρₚ = {rho_p} кг/м³, скорость v = {v0} м/с")
print(f"Плотность мишени ρₜ = {rho_t} кг/м³, g = {g} м/с²,\nτₛ = {tau_0} Па, c = {c} м/с")
print("\nВычисленные параметры:")
print(f"Масса тела m = {results['m']:.2f} кг")
print(f"Кинетическая энергия E = {results['E']:.3e} Дж")
print(f"Импульс I = {results['I']:.3e} кг·м/с")
print(f"Глубина проникновения (гидродинамическая фаза): {results['h_hydro_2']:.3f} м")
print(f"Диаметр кратера: {results['d_crater_2']:.3f} м")

print(f"Глубина проникновения (фаза твёрдого тела): {results['h_solid']:.3f} м")
print(f"Диаметр поражённой зоны: {2*results['r_solid']:.3f} м")
print(f"Общая глубина проникновения: {results['h_total']:.3f} м")
