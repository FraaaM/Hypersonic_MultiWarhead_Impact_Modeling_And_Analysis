import math

def calculate_penetration(L, r, rho_p, v0, rho_t, Y, sigma_t, c, alpha, v_crit=2000):
    """
    Функция для расчета параметров гиперзвукового удара цилиндрического снаряда.
    
    Параметры:
    - L: длина цилиндра (м)
    - r: радиус цилиндра (м)
    - rho_p: плотность снаряда (кг/м³)
    - v0: начальная скорость (м/с)
    - rho_t: плотность мишени (кг/м³)
    - Y: динамическая прочность мишени (Па)
    - sigma_t: статическая прочность мишени (Па)
    - c: скорость звука в мишени (м/с)
    - alpha: коэффициент потери массы (0 ≤ alpha < 1)
    - v_crit: критическая скорость (м/с), по умолчанию 2000 м/с
    
    Возвращает словарь с вычисленными параметрами.
    """
    # Площадь поперечного сечения
    A0 = math.pi * r**2
    
    # Объем и масса снаряда
    V = A0 * L
    m = rho_p * V
    
    # Кинетическая энергия
    E = 0.5 * m * v0**2
    
    # Импульс
    I = m * v0
    
    # Глубина проникновения (гидродинамическая фаза)
    h_hydro = (math.sqrt(rho_p / rho_t) * L * (v0**2 / (2 * Y)) * 
               math.log(1 + (rho_t * v0**2) / sigma_t))
    
    # Радиус кратера
    r_crater = (((m * v0**2 * rho_p) / (rho_t * 2*Y))**(1/3) * 
                (2 * r / L)**(1/3))
    
    # Эффективная масса после потери
    m_eff = m * (1 - alpha)
    
    # Глубина проникновения (фаза твёрдого тела)
    h_solid = (m_eff * v_crit**2) / (A0 * (rho_t * v_crit**2 + sigma_t))
    
    # Радиус поражённой зоны
    r_solid = math.sqrt((A0 * (1 + v_crit / c)) / math.pi)
    
    # Общая глубина проникновения
    h_total = h_hydro + h_solid
    
    return {
        'm': m,
        'E': E,
        'I': I,
        'h_hydro': h_hydro,
        'r_crater': r_crater,
        'h_solid': h_solid,
        'r_solid': r_solid,
        'h_total': h_total
    }

# Входные данные из примера РАКЕТА САРМАТА
L = 0.9     # длина цилиндра (м)
r = 0.43   # радиус цилиндра (м), вычислен из массы
rho_p = 8500    # плотность снаряда (кг/м³)
v0 = 5000       # начальная скорость (м/с)
rho_t = 2500    # плотность мишени (кг/м³)
Y = 1e8     # динамическая прочность (Па), подобрана для примера
sigma_t = 5e7   # статическая прочность (Па)
c = 4000        # скорость звука (м/с)
alpha = 0.603   # коэффициент потери массы, подобран для примера
g = 9.81        # ускорение свободного падения (м/с²), для вывода

# Вычисление параметров
results = calculate_penetration(L, r, rho_p, v0, rho_t, Y, sigma_t, c, alpha)

# Вывод результатов
print(f"Диаметр тела L = {L} м, радиус {r} м, плотность тела ρₚ = {rho_p} кг/м³, скорость v = {v0} м/с")
print(f"Плотность мишени ρₜ = {rho_t} кг/м³, g = {g} м/с², τₛ = {sigma_t} Па, c = {c} м/с")
print("\nВычисленные параметры:")
print(f"Масса тела m = {results['m']:.3e} кг")
print(f"Кинетическая энергия E = {results['E']:.3e} Дж")
print(f"Импульс I = {results['I']:.3e} кг·м/с")
print(f"Глубина проникновения (гидродинамическая фаза): {results['h_hydro']:.2f} м")
print(f"Радиус кратера: {results['r_crater']:.2f} м")
print(f"Глубина проникновения (фаза твёрдого тела): {results['h_solid']:.2f} м")
print(f"Радиус поражённой зоны: {results['r_solid']:.2f} м")
print(f"Общая глубина проникновения: {results['h_total']:.2f} м")